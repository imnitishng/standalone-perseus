<body style="zoom: 1; overflow: hidden;">
  <div
    style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;">
    <div id="MathJax_Hidden"></div>
  </div>
  <div id="MathJax_Message" style="display: none;"></div>
  <div id="content-container">
    <div data-reactroot="" id="measured"
      style="margin-right: 36px; border-width: 1px; border-color: black; border-style: solid;">
      Should be present but it isint which is sad
      <!-- <div class="framework-perseus fonts-loaded bibliotron-exercise " style="margin: 30px 0px;"> -->
      <div></div>
    </div>
  </div>
  <!-- <div id="perseus-area" style="margin-left: 0px"></div>
  <div id="perseus-container" style="margin-left: 0px"></div>
  <div id="hintsarea" style="margin-left: 0px"></div> -->
  <!-- Code injected by live-server -->
  <script type="text/javascript">
    // <![CDATA[  <-- For SVG support
    if ('WebSocket' in window) {
      (function () {
        function refreshCSS() {
          var sheets = [].slice.call(document.getElementsByTagName("link"));
          var head = document.getElementsByTagName("head")[0];
          for (var i = 0; i < sheets.length; ++i) {
            var elem = sheets[i];
            var parent = elem.parentElement || head;
            parent.removeChild(elem);
            var rel = elem.rel;
            if (elem.href && typeof rel != "string" || rel.length == 0 || rel.toLowerCase() == "stylesheet") {
              var url = elem.href.replace(/(&|\?)_cacheOverride=\d+/, '');
              elem.href = url + (url.indexOf('?') >= 0 ? '&' : '?') + '_cacheOverride=' + (new Date().valueOf());
            }
            parent.appendChild(elem);
          }
        }
        var protocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://';
        var address = protocol + window.location.host + window.location.pathname + '/ws';
        var socket = new WebSocket(address);
        socket.onmessage = function (msg) {
          if (msg.data == 'reload') window.location.reload();
          else if (msg.data == 'refreshcss') refreshCSS();
        };
        if (sessionStorage && !sessionStorage.getItem('IsThisFirstTime_Log_From_LiveServer')) {
          console.log('Live reload enabled.');
          sessionStorage.setItem('IsThisFirstTime_Log_From_LiveServer', true);
        }
      })();
    }
    else {
      console.error('Upgrade your browser. This Browser is NOT supported WebSocket for Live-Reloading.');
    }
	// ]]>
  </script>


  <script>
    const sorterWidgetRegex = /sorter [0-9]+/;
    const itemRendererFactory = window.React.createFactory(window.Perseus.ItemRenderer);

    const vueApp = new Vue({
      el: '#framework-perseus',
      name: 'PerseusRendererIndex',
      components: {
      },
      mixins: [],
      data: () => ({
        // Is the perseus item renderer loading?
        loading: true,
        // state about the answer
        message: null,
        // default item data
        item: {},
        itemRenderer: null,
        scratchpad: false,
        // Store a copy of the blank state of a question to clear set answers later
        blankState: null,

        message_strings: {
          showScratch: 'Show scratchpad',
          notAvailable: 'The scratchpad is not available',
          loading: 'Loading',
          hint: 'Use a hint ({hintsLeft, number} left)',
          hintExplanation: 'If you use a hint, this question will not be added to your progress',
          hintLabel: 'Hint:',
          noMoreHint: 'No more hints',
        },
      }),
      computed: {
        isMobile() {
          return false;
        },
        // this is a nasty hack. Will find a better way
        usesTouch() {
          // using mdn suggestion for most compatibility
          const isMobileBrowser = new RegExp(/Mobi*|Android/);
          return isMobileBrowser.test(window.navigator.userAgent);
        },
        itemRenderData() {
          return {
            // A property to return data formatted in the form expected by the Item Renderer
            // constructor function.
            initialHintsVisible: 0,
            item: this.item,
            workAreaSelector: '#workarea',
            problemAreaSelector: '#problem-area',
            problemNum: Math.floor(Math.random() * 1000),
            enabledFeatures: {
              highlight: true,
              toolTipFormats: true,
            },
            apiOptions: {
              // Pass in callbacks for widget interaction and focus change.
              // Here we dismiss answer error message on interaction and focus change.
              interactionCallback: this.interactionCallback,
              onFocusChange: this.dismissMessage,
              isMobile: this.isMobile,
              customKeypad: this.usesTouch,
              readOnly: !this.interactive,
            },
          };
        },
        hinted() {
          return this.itemRenderer ? this.itemRenderer.state.hintsVisible > 0 : false;
        },
        availableHints() {
          return this.itemRenderer
            ? this.itemRenderer.getNumHints() - this.itemRenderer.state.hintsVisible
            : 0;
        },
        anyHints() {
          return this.allowHints && (this.itemRenderer ? this.itemRenderer.getNumHints() : 0);
        },
      },
      watch: {
        itemId: 'loadItemData',
        itemData: 'setItemData',
        loading: 'setAnswer',
        answerState: 'resetState',
        showCorrectAnswer: 'resetState',
      },
      beforeCreate() {
        // icu.setIcuSymbols();
      },

      beforeDestroy() {
        this.clearItemRenderer();
        this.$emit('stopTracking');
      },

      created() {
        this.setPerseusData();
        // const initPromise = mathJaxPromise.then(() =>
        //   perseus.init({ skipMathJax: true, loadExtraWidgets: true })
        // );
        // // Try to load the appropriate directional CSS for the particular content
        // const cssPromise = this.$options.contentModule.loadDirectionalCSS(this.contentDirection);
        // Promise.all([initPromise, cssPromise]).then(() => {
        //   if (this.defaultFile) {
        //     this.loadItemData();
        //   } else if (this.itemData) {
        //     this.setItemData(this.itemData);
        //   }
        //   this.$emit('startTracking');
        // }); 
      },
      mounted() {
        this.$emit('mounted');
      },
      methods: {
        contentDirection() {
          return 'ltr'
        },

        setPerseusData() {
          function getJSON() {
            perseusData = { "answerArea": { "calculator": false, "chi2Table": false, "periodicTable": false, "tTable": false, "zTable": false }, "hints": [{ "content": "When we skip count by tens,  we add $10$ to each number as we count.", "images": {}, "replace": false, "widgets": {} }, { "content": "Since our first number is missing, we need to **subtract** $10$ from $790$.\n\n${790} - 10 = \\blueE{780}$", "images": {}, "replace": false, "widgets": {} }, { "content": "Now, let\u0027s add $10$ to complete the list. \n\n$\\blueE{780} \\underset{ + 10}{\\rightarrow} {790} \\underset{ + 10}{\\rightarrow}\\purpleD{800}  \\underset{ + 10}{\\rightarrow} {810}\\underset{ + 10}{\\rightarrow}  \\maroonD{820} \\underset{ + 10}{\\rightarrow} \\goldE{830}$", "images": {}, "replace": false, "widgets": {} }, { "content": "Here is the completed set of numbers:\n\n$\\blueE{780},790,\\purpleD{800} , {810} , \\maroonD{820}, \\goldE{830} $", "images": {}, "replace": false, "widgets": {} }], "itemDataVersion": { "major": 0, "minor": 1 }, "question": { "content": "**Fill in the blanks by counting by $10$s. **\n\n | | | | |\n- | - | - | - | - \n[[\u2603 numeric-input 1]] | $790$ | [[\u2603 numeric-input 2]] | $810$  |[[\u2603 numeric-input 3]] | [[\u2603 numeric-input 4]]", "images": {}, "widgets": { "numeric-input 1": { "alignment": "default", "graded": true, "options": { "answers": [{ "maxError": null, "message": "", "simplify": "required", "status": "correct", "strict": false, "value": 780 }], "coefficient": false, "labelText": "", "multipleNumberInput": false, "rightAlign": false, "size": "normal", "static": false }, "static": false, "type": "numeric-input", "version": { "major": 0, "minor": 0 } }, "numeric-input 2": { "alignment": "default", "graded": true, "options": { "answers": [{ "maxError": null, "message": "", "simplify": "required", "status": "correct", "strict": false, "value": 800 }], "coefficient": false, "labelText": "", "multipleNumberInput": false, "rightAlign": false, "size": "normal", "static": false }, "static": false, "type": "numeric-input", "version": { "major": 0, "minor": 0 } }, "numeric-input 3": { "alignment": "default", "graded": true, "options": { "answers": [{ "maxError": null, "message": "", "simplify": "required", "status": "correct", "strict": false, "value": 820 }], "coefficient": false, "labelText": "", "multipleNumberInput": false, "rightAlign": false, "size": "normal", "static": false }, "static": false, "type": "numeric-input", "version": { "major": 0, "minor": 0 } }, "numeric-input 4": { "alignment": "default", "graded": true, "options": { "answers": [{ "maxError": null, "message": "", "simplify": "required", "status": "correct", "strict": false, "value": 830 }], "coefficient": false, "labelText": "", "multipleNumberInput": false, "rightAlign": false, "size": "normal", "static": false }, "static": false, "type": "numeric-input", "version": { "major": 0, "minor": 0 } } } } }
            return perseusData
          }

          this.setItemData(getJSON());

          // function itemRenderData() {
          //   // const perseusJSON = getJSON()
          //   // setItemData(perseusJSON)

          //   return {
          //     initialHintsVisible: 0,
          //     item: getJSON(),
          //     workAreaSelector: '#workarea',
          //     problemAreaSelector: '#problem-area',
          //     problemNum: Math.floor(Math.random() * 1000),
          //     enabledFeatures: {
          //       highlight: true,
          //       toolTipFormats: true,
          //     },
          //     apiOptions: {
          //       interactionCallback: this.interactionCallback,
          //       onFocusChange: this.dismissMessage,
          //       isMobile: this.isMobile,
          //       customKeypad: this.usesTouch,
          //       readOnly: !this.interactive,
          //     },
          //   };
          // }
        },
        validateItemData(obj) {
          return (
            [
              // A somewhat protracted validator to ensure that our item data conforms
              // to that expected by the Perseus ItemRenderer,
              // c.f. https://github.com/Khan/perseus/blob/master/src/item-renderer.jsx#L35
              'calculator',
              'chi2Table',
              'periodicTable',
              'tTable',
              'zTable',
            ].reduce(
              /* eslint-disable no-mixed-operators */
              // Loop through all of the above properties and ensure that if the 'answerArea'
              // property of the item has them, then their values are set to Booleans.
              (prev, key) =>
                !(
                  !prev ||
                  (Object.prototype.hasOwnProperty.call(obj.answerArea, key) &&
                    typeof obj.answerArea[key] !== 'boolean')
                ),
              true
            ) &&
            // Check that the 'hints' property is an Array.
            Array.isArray(obj.hints) &&
            obj.hints.reduce(
              // Check that each hint in the hints array is an object (and not null)
              (prev, item) => item && typeof item === 'object',
              true
            ) &&
            // Check that the question property is an object (and not null)
            obj.question &&
            typeof obj.question === 'object'
          );
          /* eslint-enable no-mixed-operators */
        },
        renderItem() {
          // Reset the state tracking variables.
          this.loading = true;
          // Don't store blank state for another item.
          this.blankState = null;

          console.log(this.$refs.perseusContainer);

          // Create react component with current item data.
          // If the component already existed, this will perform an update.
          this.$set(
            this,
            'itemRenderer',
            window.ReactDOM.render(
              itemRendererFactory(this.itemRenderData, null),
              this.$refs.perseusContainer,
              () => {
                this.loading = false;
              }
            )
          );
        },
        resetState(val) {
          if (!val) {
            this.restoreSerializedState(this.blankState);
          }
          this.setAnswer();
        },
        clearItemRenderer() {
          // Clean up any existing itemRenderer to avoid leak memory
          // https://facebook.github.io/react/blog/2015/10/01/react-render-and-top-level-api.html
          // Nest this in a try catch block so that we can call this method aggressively
          // to ensure clean up without worrying about whether React has already cleaned up this
          // component.
          try {
            reactDOM.unmountComponentAtNode(this.$refs.perseusContainer);
            this.$set(this, 'itemRenderer', null);
          } catch (e) {
            logging.debug('Error during unmounting of item renderer', e);
          }
        },
        /*
        * Special method to extract the current state of a Perseus Sorter widget
        * as it does not currently properly support getSerializedState
        */
        addSorterState(questionState) {
          this.itemRenderer.getWidgetIds().forEach(id => {
            if (sorterWidgetRegex.test(id)) {
              if (questionState[id]) {
                const sortableComponent = this.itemRenderer.questionRenderer.getWidgetInstance(id)
                  .refs.sortable;
                questionState[id].options = sortableComponent.getOptions();
              }
            }
          });
          return questionState;
        },
        getSerializedState() {
          const hints = Object.keys(this.itemRenderer.hintsRenderer.refs).map(key =>
            this.itemRenderer.hintsRenderer.refs[key].getSerializedState()
          );
          const question = this.addSorterState(
            this.itemRenderer.questionRenderer.getSerializedState()
          );
          return {
            question,
            hints,
          };
        },
        restoreSerializedState(answerState) {
          this.itemRenderer.restoreSerializedState(answerState);
          this.itemRenderer.getWidgetIds().forEach(id => {
            if (sorterWidgetRegex.test(id)) {
              if (answerState.question[id]) {
                const sortableComponent = this.itemRenderer.questionRenderer.getWidgetInstance(id)
                  .refs.sortable;
                const newProps = Object.assign({}, sortableComponent.props, {
                  options: answerState.question[id].options,
                });
                sortableComponent.setState({ items: sortableComponent.itemsFromProps(newProps) });
              }
            }
          });
        },
        setAnswer() {
          this.blankState = this.getSerializedState();
          // If a passed in answerState is an object with the right keys, restore.
          if (
            this.itemRenderer &&
            this.answerState &&
            this.answerState.question &&
            this.answerState.hints &&
            !this.loading
          ) {
            this.restoreSerializedState(this.answerState);
          } else if (this.showCorrectAnswer && !this.loading) {
            this.setCorrectAnswer();
          } else if (this.itemRenderer && !this.loading) {
            // Not setting an answer state, but need to hide any hints.
            this.itemRenderer.setState({
              hintsVisible: 0,
            });
          }
        },
        checkAnswer() {
          if (this.itemRenderer && !this.loading) {
            const check = this.itemRenderer.scoreInput();
            this.empty = check.empty;
            if (check.message && check.empty) {
              this.message = check.message;
            } else if (!check.empty) {
              const answerState = this.getSerializedState();
              // We cannot reliably get simplified answers from Perseus, so don't try.
              const simpleAnswer = '';
              return {
                correct: check.correct,
                answerState,
                simpleAnswer,
              };
            }
          }
          return null;
        },
        takeHint() {
          if (
            this.itemRenderer &&
            this.itemRenderer.state.hintsVisible < this.itemRenderer.getNumHints()
          ) {
            this.itemRenderer.showHint();
            this.$parent.$emit('hintTaken', { answerState: this.getSerializedState() });
          }
        },
        interactionCallback() {
          this.$emit('interaction');
          this.dismissMessage();
        },
        dismissMessage() {
          // dismiss the error message when user click anywhere inside the perseus element.
          this.message = null;
        },
        loadItemData() {
          // Only try to do this if itemId is defined.
          // if (this.itemId && this.defaultFile && this.defaultFile.storage_url) {
          //   this.loading = true;
          //   client(`${this.defaultFile.storage_url}${this.itemId}.json`)
          //     .then(itemResponse => {
          //       // Replace any placeholder values for image URLs with the `web+graphie:` prefix
          //       // before any others, as they are parsed slightly differently to standard image
          //       // urls (Perseus adds the protocol in place of `web+graphie:`).
          //       const itemData = JSON.parse(JSON.stringify(itemResponse.entity).replace(
          //         /web\+graphie:\$\{☣ LOCALPATH\}\//g,
          //         `web+graphie://${window.location.host}${this.defaultFile.storage_url}`
          //       )
          //         // Replace any placeholder values for image URLs with
          //         // the base URL for the perseus file we are reading from
          //         .replace(
          //           /\$\{☣ LOCALPATH\}\//g,
          //           `${window.location.protocol}//${window.location.host}${this.defaultFile.storage_url}`
          //         ));
          //       this.setItemData(itemData);
          //     })
          //     .catch(reason => {
          //       logging.debug('There was an error loading the assessment item data: ', reason);
          //       this.clearItemRenderer();
          //       this.$emit('itemError', reason);
          //     });
          // }
        },
        setItemData(itemData) {
          this.item = itemData;
          if (this.validateItemData(itemData)) {
            if (this.$el) {
              console.log('rendering');
              // Don't try to render if our component is not mounted yet.
              this.renderItem();
            } else {
              console.log('listening');
              this.$once('mounted', this.renderItem);
            }
          } else {
            logging.warn('Loaded item was malformed', itemData);
          }
        },
        setCorrectAnswer() {
          const questionRenderer = this.itemRenderer.questionRenderer;
          const widgetProps = questionRenderer.state.widgetInfo;

          const gradedWidgetIds = questionRenderer.widgetIds.filter(id => {
            return widgetProps[id].graded == null || widgetProps[id].graded;
          });

          try {
            gradedWidgetIds.forEach(id => {
              const props = widgetProps[id];
              const widget = questionRenderer.getWidgetInstance(id);
              if (!widget) {
                // This can occur if the widget has not yet been rendered
                return;
              }
              widgetSolver(widget, props.type, props.options);
            });
          } catch (e) {
            this.$emit('answerUnavailable');
          }
        },
      }
    })

  // this.data = {
  //   // Is the perseus item renderer loading?
  //   loading: true,
  //   // state about the answer
  //   message: null,
  //   // default item data
  //   item: {},
  //   itemRenderer: null,
  //   scratchpad: false,
  //   // Store a copy of the blank state of a question to clear set answers later
  //   blankState: null,
  // }

  // function loadExerciseContent() {
    // function getJSON() {
    //   perseusData = { "answerArea": { "calculator": false, "chi2Table": false, "periodicTable": false, "tTable": false, "zTable": false }, "hints": [{ "content": "When we skip count by tens,  we add $10$ to each number as we count.", "images": {}, "replace": false, "widgets": {} }, { "content": "Since our first number is missing, we need to **subtract** $10$ from $790$.\n\n${790} - 10 = \\blueE{780}$", "images": {}, "replace": false, "widgets": {} }, { "content": "Now, let\u0027s add $10$ to complete the list. \n\n$\\blueE{780} \\underset{ + 10}{\\rightarrow} {790} \\underset{ + 10}{\\rightarrow}\\purpleD{800}  \\underset{ + 10}{\\rightarrow} {810}\\underset{ + 10}{\\rightarrow}  \\maroonD{820} \\underset{ + 10}{\\rightarrow} \\goldE{830}$", "images": {}, "replace": false, "widgets": {} }, { "content": "Here is the completed set of numbers:\n\n$\\blueE{780},790,\\purpleD{800} , {810} , \\maroonD{820}, \\goldE{830} $", "images": {}, "replace": false, "widgets": {} }], "itemDataVersion": { "major": 0, "minor": 1 }, "question": { "content": "**Fill in the blanks by counting by $10$s. **\n\n | | | | |\n- | - | - | - | - \n[[\u2603 numeric-input 1]] | $790$ | [[\u2603 numeric-input 2]] | $810$  |[[\u2603 numeric-input 3]] | [[\u2603 numeric-input 4]]", "images": {}, "widgets": { "numeric-input 1": { "alignment": "default", "graded": true, "options": { "answers": [{ "maxError": null, "message": "", "simplify": "required", "status": "correct", "strict": false, "value": 780 }], "coefficient": false, "labelText": "", "multipleNumberInput": false, "rightAlign": false, "size": "normal", "static": false }, "static": false, "type": "numeric-input", "version": { "major": 0, "minor": 0 } }, "numeric-input 2": { "alignment": "default", "graded": true, "options": { "answers": [{ "maxError": null, "message": "", "simplify": "required", "status": "correct", "strict": false, "value": 800 }], "coefficient": false, "labelText": "", "multipleNumberInput": false, "rightAlign": false, "size": "normal", "static": false }, "static": false, "type": "numeric-input", "version": { "major": 0, "minor": 0 } }, "numeric-input 3": { "alignment": "default", "graded": true, "options": { "answers": [{ "maxError": null, "message": "", "simplify": "required", "status": "correct", "strict": false, "value": 820 }], "coefficient": false, "labelText": "", "multipleNumberInput": false, "rightAlign": false, "size": "normal", "static": false }, "static": false, "type": "numeric-input", "version": { "major": 0, "minor": 0 } }, "numeric-input 4": { "alignment": "default", "graded": true, "options": { "answers": [{ "maxError": null, "message": "", "simplify": "required", "status": "correct", "strict": false, "value": 830 }], "coefficient": false, "labelText": "", "multipleNumberInput": false, "rightAlign": false, "size": "normal", "static": false }, "static": false, "type": "numeric-input", "version": { "major": 0, "minor": 0 } } } } }
    //   return perseusData
    // }

    // function itemRenderData() {
    //   const perseusJSON = getJSON()
    //   // setItemData(perseusJSON)

    //   return {
    //     initialHintsVisible: 0,
    //     item: getJSON(),
    //     workAreaSelector: '#workarea',
    //     problemAreaSelector: '#problem-area',
    //     problemNum: Math.floor(Math.random() * 1000),
    //     enabledFeatures: {
    //       highlight: true,
    //       toolTipFormats: true,
    //     },
    //     apiOptions: {
    //       interactionCallback: this.interactionCallback,
    //       onFocusChange: this.dismissMessage,
    //       isMobile: this.isMobile,
    //       customKeypad: this.usesTouch,
    //       readOnly: !this.interactive,
    //     },
    //   };
    // }

  //   this.data.itemRenderer = window.ReactDOM.render(
  //     itemRendererFactory(itemRenderData()),
  //     document.getElementById("perseus-area"),
  //     () => {
  //       this.data.loading = false
  //     }
  //   )
  // }

  </script>


  <div id="MathJax_Font_Test"
    style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size1, monospace;">
    () [] {} </div>
</body>